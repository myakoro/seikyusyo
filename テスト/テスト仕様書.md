# スマート受発注 mini テスト仕様書

本書は「スマート受発注 mini テスト計画書.md」に基づき、画面・機能ごとの具体的なテストケースを定義する。

共通の項目:

- **テストケースID**: 画面IDベースの一意なID（例: `TC-SC01-001`）
- **観点**: 何を確認するテストか（機能／バリデーション／権限制御 等）
- **前提条件**: データ・ユーザー権限・画面遷移など、テスト開始前の状態
- **手順**: 画面操作レベルでのステップ
- **期待結果**: 画面表示・DB更新・ステータス変更など、テスト成功時の結果

---

## 1. 共通前提条件

- 自社ユーザー用のテストアカウントが作成済みであること。
- フリーランス用のテストアカウントが作成済みであること。
- 詳細設計書に記載のマスタデータ（税率、ステータスなど）が初期登録されていること。

---

## 2. SC-01 ログイン

### 2.1 正常系

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC01-001 | 正常ログイン（自社ユーザー） | 有効な自社ユーザーのID/パスワードが登録済み。 | 1. ログイン画面（SC-01）を表示 2. ユーザーIDに有効なIDを入力 3. パスワードに正しいパスワードを入力 4. 「ログイン」ボタン押下 | ダッシュボード（SC-03）が表示されること。ヘッダーにログインユーザー名が表示されること。 |
| TC-SC01-002 | 「ログイン状態を保持」チェック時のログイン | 有効な自社ユーザーが存在すること。ブラウザのCookieが有効であること。 | 1. SC-01を表示 2. 正しいユーザーID/パスワードを入力 3. 「ログイン状態を保持」にチェック 4. 「ログイン」押下 5. ブラウザを一度閉じて再度アクセス | 再アクセス時に再ログインなしでダッシュボード（SC-03）が表示されること。 |

### 2.2 異常系・バリデーション

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC01-003 | ID・パスワード誤り | なし | 1. SC-01を表示 2. 存在しないIDまたは誤ったパスワードを入力 3. 「ログイン」押下 | 「ユーザーIDまたはパスワードが正しくありません」等のエラーメッセージが赤字で表示されること。画面遷移しないこと。 |
| TC-SC01-004 | 必須項目未入力 | なし | 1. SC-01を表示 2. ユーザーID・パスワードのいずれか、または両方を空欄のまま「ログイン」押下 | ユーザーID・パスワードが必須である旨のエラーメッセージが表示されること。 |

---

## 3. SC-02 パスワードリセット案内

### 3.1 表示・遷移

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC02-001 | 案内文言の表示 | なし | 1. ログイン画面（SC-01）から「パスワードを忘れた方」リンクをクリック | SC-02が表示され、「パスワードをお忘れの場合は、スタッフまでお問い合わせください。」の案内文が表示されていること。 |
| TC-SC02-002 | ログイン画面への戻り | SC-02が表示されていること。 | 1. SC-02で「ログイン画面に戻る」ボタンをクリック | SC-01に遷移すること。 |

---

## 4. SC-03 ダッシュボード

### 4.1 表示

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC03-001 | サマリー表示 | 複数の請求書データが登録済み。 | 1. 自社ユーザーでログイン 2. SC-03を表示 | 「今月の請求書件数」「今月の請求額合計」「支払予定件数」が表示され、件数・金額が要件・設計書どおりに集計されていること。 |
| TC-SC03-002 | 最近の請求書一覧表示 | 過去に作成済みの請求書が5件以上存在すること。 | 1. 自社ユーザーでログイン 2. SC-03を表示 | 「最近の請求書」セクションに最新5件が表示され、請求書番号・フリーランス名・金額・ステータスが正しく表示されていること。 |

---

## 5. SC-04 請求書一覧

### 5.1 正常系

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC04-001 | 一覧表示 | 複数の請求書データが登録済み。 | 1. 自社ユーザーでログイン 2. メニューから「請求書一覧」（SC-04）を開く | 一覧に請求書番号、フリーランス名、請求額、ステータスなどが表示されること。 |
| TC-SC04-002 | ステータス絞り込み | ステータスの異なる請求書（例: 下書き、承認待ち、承認済み）が存在すること。 | 1. SC-04を表示 2. ステータスフィルタで「承認待ち」を選択 3. 「検索」押下 | 承認待ちの請求書のみが一覧に表示されること。 |

### 5.2 ページネーション

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC04-003 | ページ遷移 | 1ページあたりの表示件数を超える請求書が存在すること。 | 1. SC-04を表示 2. 一覧下部のページネーションから次ページを選択 | 次ページの請求書一覧が表示されること。 |

---

## 6. SC-05 請求書作成

### 6.1 正常系

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC05-001 | 請求書の新規作成（税別・源泉あり） | 有効なフリーランス・商品マスタが登録済み。 | 1. 自社ユーザーでログイン 2. メニューから「請求書作成」（SC-05）を開く 3. フリーランスを選択 4. 明細に商品マスタから行を追加 5. 数量・報酬率を入力 6. 「保存」押下 | 新しい請求書が作成され、SC-04およびSC-07で内容が確認できること。金額（税別）、消費税、源泉所得税、請求額がビジネスロジック設計どおりに計算されていること。 |
| TC-SC05-002 | 明細の税別表示 | 消費税設定「別」の商品マスタが存在すること。 | 1. SC-05で対象フリーランスを選択 2. 消費税「別」の商品を明細に追加 3. 数量・報酬率を入力 | 明細行の「金額（税別）」が、単価×数量×報酬率に基づく税別金額として表示されていること。 |

### 6.2 異常系・バリデーション

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC05-003 | 必須項目未入力 | なし | 1. SC-05を開く 2. フリーランス未選択、請求締日・支払予定日未入力のまま「保存」押下 | 画面設計書の必須項目に対応したエラーメッセージが表示され、保存処理が行われないこと。 |
| TC-SC05-004 | 数値項目の異常値 | なし | 1. SC-05で明細行の数量にマイナス値や0を入力 2. 「保存」押下 | 「数量は1以上で入力してください」等、仕様どおりのバリデーションエラーが表示されること。 |

---

## 7. SC-06 請求書編集

### 7.1 正常系

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC06-001 | 下書き請求書の編集 | ステータス=下書きの請求書が1件存在すること。 | 1. SC-04から下書き請求書の「編集」をクリックしSC-06を開く 2. 明細の数量を変更 3. 「保存」押下 | 請求書の金額が再計算され、SC-04/SC-07にも反映されること。 |

### 7.2 ステータス制御

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC06-002 | 承認済み請求書の編集制御 | ステータス=承認済みの請求書が存在すること。 | 1. SC-04から承認済み請求書の「編集」をクリック 2. SC-06を表示 | 明細や基本情報の編集ができない、または「編集不可」である旨のUI制御が行われていること。 |

---

## 8. SC-07 請求書詳細（自社）

### 8.1 表示

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC07-001 | お支払先・支払元情報の表示 | 請求書にフリーランス・自社情報が紐づいていること。 | 1. SC-04から任意の請求書の「詳細」をクリックしSC-07を開く | 「お支払先」「支払元」セクションに、氏名（または会社名）、住所、電話番号、適格請求書発行事業者登録番号（お支払先のみ）がモックアップどおりに表示されていること。 |

### 8.2 支払済処理

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC07-002 | 支払済へのステータス変更 | ステータス=承認済みの請求書が存在すること。 | 1. SC-07を開く 2. 「支払済にする」ボタンをクリック 3. 確認モーダルで「OK」を押下 | 請求書ステータスが「支払済」に更新され、ステータス履歴にも反映されること。 |

---

## 9. SC-07 請求書詳細（フリーランス）

### 9.1 承認・差し戻し

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC07FL-001 | 承認モーダル表示 | フリーランスユーザーでログインし、自分宛て請求書が承認待ちで存在すること。 | 1. フリーランスユーザーでログイン 2. 該当請求書の詳細（SC-07-freelancer）を開く 3. 「承認」ボタンをクリック | 承認確認モーダルが表示されること。 |
| TC-SC07FL-002 | 差し戻しモーダル表示・コメント入力 | 同上 | 1. 「差し戻し」ボタンをクリック 2. 差し戻し理由コメントを入力 3. 「送信」押下 | ステータスが「差し戻し」に変更され、コメントが履歴または関連箇所に保存されること。 |

---

## 10. SC-08 フリーランス一覧

### 10.1 一覧・検索

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC08-001 | 一覧表示 | 複数のフリーランスが登録済み。 | 1. 自社ユーザーでログイン 2. メニューからフリーランス一覧（SC-08）を開く | フリーランスの氏名、メールアドレス、電話番号、ステータスが一覧表示されること。 |
| TC-SC08-002 | 氏名検索 | フリーランスA, Bが登録済み。 | 1. SC-08を表示 2. 氏名検索欄にフリーランスAの一部文字列を入力 3. 「検索」押下 | フリーランスAのみが表示されること。 |

---

## 11. SC-09 フリーランス登録

### 11.1 正常系

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC09-001 | 必須項目を入力して新規登録 | なし | 1. 自社ユーザーでログイン 2. SC-09を開く 3. 氏名、メールアドレス、電話番号、郵便番号、住所、銀行名、支店名、口座種別、口座番号、口座名義など必須項目を入力 4. 「登録」押下 | フリーランスが新規登録され、SC-08の一覧に表示されること。 |

### 11.2 インボイス番号形式（UIレベル）

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC09-002 | 適格請求書発行事業者登録番号の入力補助 | なし | 1. SC-09を開く 2. 適格請求書発行事業者登録番号欄にフォーカス 3. "T1234567890123" 形式の値を入力 | 入力欄に `maxLength=14` が設定されていること、プレースホルダやヘルプテキストがモックどおりに表示されていること（実装側のバリデーション詳細は別途単体テストで確認）。 |

---

## 12. SC-10 フリーランス編集

### 12.1 正常系

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC10-001 | 登録済みフリーランスの編集 | 既にフリーランスが1件登録済み。 | 1. SC-08から対象フリーランスの「編集」をクリックしSC-10を開く 2. 電話番号や住所を変更 3. 「更新」押下 | 変更内容がDBに保存され、SC-08および関連画面で反映されること。 |

---

## 13. SC-11〜SC-13 商品マスタ

### 13.1 一覧・登録・編集

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC11-001 | 商品一覧表示 | フリーランスに紐づく商品マスタが複数件登録済み。 | 1. 自社ユーザーでログイン 2. SC-11を表示 | フリーランス名、商品名、単価、消費税設定、税率、源泉税対象、ステータスが一覧表示されること。 |
| TC-SC12-001 | 新規商品登録 | 対象フリーランスが有効で存在すること。 | 1. SC-12を開く 2. フリーランス、商品名、単価、消費税区分、税率、源泉税対象、ステータスを入力 3. 「登録」押下 | 商品マスタが登録され、SC-11一覧に表示されること。 |
| TC-SC13-001 | 既存商品の編集 | 商品マスタが1件以上登録済み。 | 1. SC-11から対象商品の「編集」をクリックしSC-13を開く 2. 単価やステータスを変更 3. 「更新」押下 | 変更内容が保存され、請求書作成画面の明細候補にも反映されること。 |

---

## 14. SC-14 自社情報設定

### 14.1 必須項目

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC14-001 | 自社情報の登録・更新 | なし | 1. 自社ユーザーでログイン 2. SC-14を表示 3. 会社名、郵便番号、住所、電話番号、メールアドレスを入力 4. 「更新」押下 | 自社情報が登録・更新され、エラーなく完了メッセージが表示されること。 |
| TC-SC14-002 | 必須項目未入力エラー | なし | 1. SC-14で郵便番号または住所または電話番号またはメールアドレスを空欄にして「更新」押下 | それぞれの項目が必須である旨のエラーメッセージが表示され、更新処理が行われないこと。 |

---

## 15. SC-15 ユーザー管理

### 15.1 ユーザー招待

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC15-001 | 新規ユーザー招待 | 管理権限を持つ自社ユーザーでログインしていること。 | 1. SC-15を表示 2. 「新規ユーザー招待」をクリック 3. 名前・メールアドレス・ロールを入力し招待実行 | ユーザー一覧に新しいユーザーが招待状態で追加されること。招待用情報（URL・ID・仮パスワード）が画面上に表示されること。 |

---

## 16. SC-16 マイページ（フリーランス）

### 16.1 自身の情報・請求書一覧

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC16-001 | マイページ表示 | フリーランスユーザーでログイン可能な状態であること。 | 1. フリーランスユーザーでログイン 2. SC-16を表示 | 自身の登録情報（氏名、住所、適格請求書発行事業者登録番号等）と、自分に紐づく請求書一覧が表示されること。 |

### 16.2 承認・差し戻し

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-SC16-002 | 請求書承認 | 自分宛の請求書が承認待ちで1件以上存在すること。 | 1. SC-16を表示 2. 承認待ち請求書の行から「承認」ボタンをクリック 3. 承認確認モーダルで「OK」押下 | 対象請求書のステータスが「承認済み」となり、SC-07-freelancer および自社側SC-07にも反映されること。 |
| TC-SC16-003 | 差し戻し | 同上 | 1. SC-16を表示 2. 承認待ち請求書の「差し戻し」ボタンをクリック 3. 差し戻し理由を入力し「送信」押下 | ステータスが「差し戻し」となり、自社側の請求書詳細画面でも差し戻し状態およびコメントが確認できること。 |

---

## 17. PDF 請求書出力

### 17.1 レイアウト・金額表示

| テストケースID | 観点 | 前提条件 | 手順 | 期待結果 |
|-----------------|------|----------|------|----------|
| TC-PDF-001 | PDFレイアウトの一致 | 請求書が1件以上存在すること。 | 1. SC-07（自社）から対象請求書の「PDF出力」ボタンを押下 2. 生成されたPDFを表示 | PDFのレイアウトが `mockup/PDF_invoice-layout.html` と同等であり、ヘッダー、 お支払先・支払元、振込先情報、明細テーブル、集計、備考がモックアップどおりに配置されていること。 |
| TC-PDF-002 | 金額・税計算の整合 | 源泉税対象・非対象の明細を含む請求書が存在すること。 | 1. 上記と同じ請求書でPDFを出力 2. 画面上の請求書詳細（SC-07）とPDFの金額・税額・源泉所得税・請求額を比較 | 画面とPDFの金額・税額・請求額が一致し、ビジネスロジック設計どおりに計算されていること。 |
