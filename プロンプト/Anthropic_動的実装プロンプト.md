# Anthropic（Claude）- スマート受発注 mini 動的実装プロンプト

## あなたの役割

あなたは**フルスタックエンジニア**です。「スマート受発注 mini」（請求書発行システム）の動的実装を行ってください。

**重要**: UIモックアップは既に完成しています。モックアップのデザイン・レイアウトを**必ず守って**実装してください。

---

## 📚 必ず参照すべきドキュメント

### 設計書（実装の根拠）

| ドキュメント | パス | 内容 |
|-------------|------|------|
| 要件定義書 | `要件定義書/要件定義書.md` | システム全体の要件、機能要件、非機能要件 |
| システム前提条件 | `詳細設計書/01_システム前提条件・構成.md` | 技術スタック、システム構成 |
| データベース設計 | `詳細設計書/02_データベース設計.md` | テーブル定義、ER図、リレーション |
| 画面設計 | `詳細設計書/03_画面設計.md` | 全16画面の仕様、バリデーション、画面遷移 |
| API設計 | `詳細設計書/04_API設計.md` | 全APIエンドポイント、リクエスト/レスポンス |
| ビジネスロジック | `詳細設計書/05_ビジネスロジック設計.md` | 計算ロジック、ステータス遷移 |
| セキュリティ・PDF | `詳細設計書/06_セキュリティ・PDF・エラーハンドリング.md` | 認証、PDF生成、エラー処理 |
| デプロイ設計 | `詳細設計書/07_デプロイ設計・開発計画.md` | デプロイ手順、開発フェーズ |

### UIモックアップ（デザインの根拠）

| 画面 | パス | 説明 |
|------|------|------|
| モック一覧 | `mockup/index.html` | 全モックへのリンク |
| ログイン | `mockup/SC-01_login.html` | SC-01 |
| パスワードリセット | `mockup/SC-02_reset-password.html` | SC-02（案内ページ） |
| ダッシュボード | `mockup/SC-03_dashboard.html` | SC-03 |
| 請求書一覧 | `mockup/SC-04_invoice-list.html` | SC-04 |
| 請求書作成 | `mockup/SC-05_invoice-new.html` | SC-05 |
| 請求書編集 | `mockup/SC-06_invoice-edit.html` | SC-06 |
| 請求書詳細（自社） | `mockup/SC-07_invoice-detail.html` | SC-07 |
| 請求書詳細（FL） | `mockup/SC-07_invoice-detail-freelancer.html` | SC-07（フリーランス用） |
| フリーランス一覧 | `mockup/SC-08_freelancer-list.html` | SC-08 |
| フリーランス登録 | `mockup/SC-09_freelancer-new.html` | SC-09 |
| フリーランス編集 | `mockup/SC-10_freelancer-edit.html` | SC-10 |
| 商品マスタ一覧 | `mockup/SC-11_product-list.html` | SC-11 |
| 商品マスタ登録 | `mockup/SC-12_product-new.html` | SC-12 |
| 商品マスタ編集 | `mockup/SC-13_product-edit.html` | SC-13 |
| 自社情報設定 | `mockup/SC-14_settings-company.html` | SC-14 |
| ユーザー管理 | `mockup/SC-15_settings-users.html` | SC-15 |
| マイページ | `mockup/SC-16_mypage.html` | SC-16（フリーランス用） |
| PDFレイアウト | `mockup/PDF_invoice-layout.html` | PDF出力のレイアウト |

---

## 🛠 技術スタック

`詳細設計書/01_システム前提条件・構成.md` に従い、以下を使用：

### フロントエンド
- **Next.js 14+**（App Router）
- **TypeScript**
- **React 18+**
- **Tailwind CSS**
- **React Hook Form + Zod**（フォーム・バリデーション）

### バックエンド
- **Next.js API Routes**（App Router）
- **Prisma**（ORM）
- **PostgreSQL**（データベース）

### 認証
- **NextAuth.js**

### PDF生成
- **@react-pdf/renderer**

---

## 📋 実装する機能一覧

### フェーズ1: 基盤構築
1. プロジェクトセットアップ（Next.js, Prisma, Tailwind）
2. データベーススキーマ作成（`詳細設計書/02_データベース設計.md`）
3. 認証機能（NextAuth.js）
4. 共通レイアウト・コンポーネント

### フェーズ2: マスタ管理
5. 自社情報設定（SC-14）
6. ユーザー管理（SC-15）
7. フリーランス管理（SC-08, SC-09, SC-10）
8. 商品マスタ管理（SC-11, SC-12, SC-13）

### フェーズ3: 請求書管理
9. 請求書一覧（SC-04）
10. 請求書作成（SC-05）- 計算ロジック含む
11. 請求書編集（SC-06）
12. 請求書詳細（SC-07）
13. ダッシュボード（SC-03）

### フェーズ4: フリーランス機能
14. マイページ（SC-16）
15. 請求書承認・差し戻し機能

### フェーズ5: PDF・仕上げ
16. PDF生成機能（`mockup/PDF_invoice-layout.html` のレイアウト厳守）
17. テスト・バグ修正

---

## ⚠️ 重要な実装ルール

### 1. UIはモックアップを厳守
- `mockup/` 内のHTMLファイルのデザイン・レイアウトを再現
- 色、余白、フォントサイズ、配置を変えない
- CSSは `mockup/css/style.css` を参考に

### 2. 用語の統一
- 「お支払先」= フリーランス（取引先）
- 「支払元」= 自社
- 「適格請求書発行事業者登録番号」（インボイス番号ではない）

### 3. 必須項目
- フリーランス登録: 氏名、メール、電話番号、郵便番号、住所、銀行名、支店名、口座種別、口座番号、口座名義
- 自社情報: 会社名、郵便番号、住所、電話番号、メールアドレス
- 適格請求書発行事業者登録番号: 任意（形式: T + 数字13桁）

### 4. 計算ロジック
`詳細設計書/05_ビジネスロジック設計.md` に従う：
- 源泉所得税: 10.21%
- 消費税: 10%（込/別の設定あり）
- 金額表示は税別

### 5. ステータス遷移
```
下書き → 承認待ち → 承認済み → 支払済み
              ↓
          差し戻し → 下書き
```

---

## 📁 推奨ディレクトリ構成

```
src/
├── app/
│   ├── (auth)/
│   │   ├── login/
│   │   └── reset-password/
│   ├── (dashboard)/
│   │   ├── layout.tsx
│   │   ├── page.tsx              # ダッシュボード
│   │   ├── invoices/
│   │   ├── freelancers/
│   │   ├── products/
│   │   └── settings/
│   ├── (freelancer)/
│   │   └── mypage/
│   └── api/
│       ├── auth/
│       ├── invoices/
│       ├── freelancers/
│       ├── products/
│       └── company/
├── components/
│   ├── ui/                       # 共通UIコンポーネント
│   ├── layout/                   # レイアウト
│   └── forms/                    # フォーム
├── lib/
│   ├── prisma.ts
│   ├── auth.ts
│   ├── validations/              # Zodスキーマ
│   └── pdf/                      # PDF生成
└── types/
```

---

## ✅ 実装完了チェックリスト

各画面・機能の実装後、以下を確認：

- [ ] モックアップとデザインが一致している
- [ ] `03_画面設計.md` のバリデーションが実装されている
- [ ] `04_API設計.md` のエンドポイントが実装されている
- [ ] `05_ビジネスロジック設計.md` の計算が正しい
- [ ] エラーハンドリングが適切
- [ ] レスポンシブ対応（モックアップ準拠）

---

## 🚀 開始手順

1. まず `mockup/index.html` をブラウザで開き、全画面のデザインを確認
2. `詳細設計書/` の各ドキュメントを読み込む
3. フェーズ1から順に実装を開始
4. 各画面実装後、モックアップと見比べて確認

---

**質問があれば、該当する設計書のセクションを参照してください。**
